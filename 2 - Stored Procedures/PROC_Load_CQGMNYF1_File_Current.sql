USE [GMIDATA]
GO

DROP PROCEDURE [dbo].[PROC_Load_CQGMNYF1_File_Current]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[PROC_Load_CQGMNYF1_File_Current]

AS

SET NOCOUNT ON

PRINT '************************************************************************************************************'
PRINT ' [dbo].[PROC_Load_CQGMNYF1_File_Current] STARTED'
PRINT '************************************************************************************************************'
SELECT GETDATE() "Start Time"

PRINT '**************************************************************************'
PRINT ' TRUNCATE TABLE [dbo].[CQGMNYF1_File_Current]'
PRINT '**************************************************************************'
TRUNCATE TABLE [dbo].[CQGMNYF1_File_Current]

PRINT '**************************************************************************'
PRINT ' Load [dbo].[CQGMNYF1_File_Current]'
PRINT ' with [dbo].[CQGMNYF1_File_Raw]'
PRINT '**************************************************************************'

SELECT GETDATE() "Start Time"

INSERT INTO [dbo].[CQGMNYF1_File_Current]
(MRECID,
MFIRM,
MOFFIC,
MACCT,
MATYPE,
MRR,
MCLASS,
MSUBCL,
MCURAT,
MCURCD,
MCURAC,
MCURFM,
MCPCOD,
MNCALL,
MCAGE,
MFILL1,
MAVDYS,
MDSCCD,
MOMNCD,
MACNTY,
MMPGMN,
MSNAME,
MNA1,
MDLACT,
MDLACW,
MREL1F,
MREL1O,
MREL1A,
MREL1T,
MREL2F,
MREL2O,
MREL2A,
MREL2T,
MREL3F,
MREL3O,
MREL3A,
MREL3T,
MGRPFM,
MGRPOF,
MGRPRR,
MGRPAC,
MBAL,
MLMV,
MSMV,
MLOV,
MSOV,
MTC,
MWF,
MFIR,
MFMR,
MFEXIR,
MME,
MOTE,
MSMA,
MLOOTE,
MSOOTE,
MAVGEQ,
MMTDCM,
MUNLMV,
MTDBAL,
MUNSMV,
MMMHC,
MUNDPC,
MMTDPL,
MSEGLV,
MSEGSV,
MEIR,
MEMR,
MCVTFB,
MDVBAL,
MJPUPL,
MFOOTE,
MLOANV,
MBYPWR,
MPNDIV,
MPNINT,
MLQVAL,
MMRGVL,
MOTECR,
MOTEDR,
MPREM,
MOOTEC,
MAVSOD,
MLOPRM,
MUNUPL,
MAVGME,
MJPIR,
MJPIRC,
MJPMR,
MJPRT2,
MTAR,
MEPOTE,
MLVUST,
MTE,
MAVGBL,
MAVGOV,
MCVTAB,
MCMACR,
MCMACU,
MSPNOV,
MEEXM,
MEIRT,
MEOIR,
MEOMR,
MFEXMR,
MGEUDC,
MNCOTE,
MCCDNT,
MEQPCT,
MREGCV,
MCVTAF,
MTDVAL,
MTCC,
MMRGLM,
MPNOTH,
MIRCIC,
MIRCEC,
MDEFOT,
MSECAM,
MCLMGN,
MCLOTE,
MSPNAE,
MMVUCI,
MACRET,
MPOOTE,
MUNDEP,
MPRTC,
MPRSMA,
MLVTM4,
MLVTM3,
MLVTM2,
MPREOI,
MPREIR,
MPRFXM,
MPRFXI,
MPRFIR,
MPROTE,
MPRTE,
MPRLQV,
MPRRCV,
MPRBAL,
MBNRY1,
MBNRY2,
MBNRY3,
MBNRY4,
MBNRY5,
MMISC1,
MMISC2,
MMISC3,
MMISC4,
MMISC5,
MMISC6,
MMISC7,
MMISC8,
MMISC9,
MMISC0,
MCND01,
MCND02,
MCND03,
MCND04,
MCND05,
MCND06,
MCND07,
MCND08,
MCND09,
MCND10,
MUSFL1,
MUSFL2,
MUSFL3,
MUSFL4,
MUSFL5,
MUSFL6,
MUSFL7,
MUSFL8,
MUSFL9,
MUSFLA,
MUKFL1,
MUKFL2,
MUKFL3,
MUKFL4,
MFRFL1,
MFRFL2,
MFRFL3,
MJPFL1,
MJPFL2,
MJPFL3,
MHKFL1,
MGEFL1,
MITFL1,
EOREC)
SELECT --TOP 10
SUBSTRING(CQGMNYF1_Record,1,1),--MRECID
SUBSTRING(CQGMNYF1_Record,2,1),--MFIRM
SUBSTRING(CQGMNYF1_Record,3,3),--MOFFIC
SUBSTRING(CQGMNYF1_Record,6,5),--MACCT
SUBSTRING(CQGMNYF1_Record,11,2),--MATYPE
SUBSTRING(CQGMNYF1_Record,13,5),--MRR
SUBSTRING(CQGMNYF1_Record,18,1),--MCLASS
SUBSTRING(CQGMNYF1_Record,19,1),--MSUBCL
SUBSTRING(CQGMNYF1_Record,20,3),--MCURAT
SUBSTRING(CQGMNYF1_Record,23,2),--MCURCD
SUBSTRING(CQGMNYF1_Record,25,3),--MCURAC
SUBSTRING(CQGMNYF1_Record,28,3),--MCURFM
SUBSTRING(CQGMNYF1_Record,31,1),--MCPCOD
SUBSTRING(CQGMNYF1_Record,32,4),--MNCALL
SUBSTRING(CQGMNYF1_Record,36,4),--MCAGE
SUBSTRING(CQGMNYF1_Record,40,1),--MFILL1
SUBSTRING(CQGMNYF1_Record,41,4),--MAVDYS
SUBSTRING(CQGMNYF1_Record,45,1),--MDSCCD
SUBSTRING(CQGMNYF1_Record,46,1),--MOMNCD
SUBSTRING(CQGMNYF1_Record,47,2),--MACNTY
SUBSTRING(CQGMNYF1_Record,49,2),--MMPGMN
SUBSTRING(CQGMNYF1_Record,51,20),--MSNAME
SUBSTRING(CQGMNYF1_Record,71,32),--MNA1
SUBSTRING(CQGMNYF1_Record,103,11),--MDLACT
SUBSTRING(CQGMNYF1_Record,114,9),--MDLACW
SUBSTRING(CQGMNYF1_Record,123,1),--MREL1F
SUBSTRING(CQGMNYF1_Record,124,3),--MREL1O
SUBSTRING(CQGMNYF1_Record,127,5),--MREL1A
SUBSTRING(CQGMNYF1_Record,132,1),--MREL1T
SUBSTRING(CQGMNYF1_Record,133,1),--MREL2F
SUBSTRING(CQGMNYF1_Record,134,3),--MREL2O
SUBSTRING(CQGMNYF1_Record,137,5),--MREL2A
SUBSTRING(CQGMNYF1_Record,142,1),--MREL2T
SUBSTRING(CQGMNYF1_Record,143,1),--MREL3F
SUBSTRING(CQGMNYF1_Record,144,3),--MREL3O
SUBSTRING(CQGMNYF1_Record,147,5),--MREL3A
SUBSTRING(CQGMNYF1_Record,152,1),--MREL3T
SUBSTRING(CQGMNYF1_Record,153,1),--MGRPFM
SUBSTRING(CQGMNYF1_Record,154,3),--MGRPOF
SUBSTRING(CQGMNYF1_Record,157,5),--MGRPRR
SUBSTRING(CQGMNYF1_Record,162,5),--MGRPAC
SUBSTRING(CQGMNYF1_Record,167,17),--MBAL
SUBSTRING(CQGMNYF1_Record,184,17),--MLMV
SUBSTRING(CQGMNYF1_Record,201,17),--MSMV
SUBSTRING(CQGMNYF1_Record,218,17),--MLOV
SUBSTRING(CQGMNYF1_Record,235,17),--MSOV
SUBSTRING(CQGMNYF1_Record,252,17),--MTC
SUBSTRING(CQGMNYF1_Record,269,17),--MWF
SUBSTRING(CQGMNYF1_Record,286,17),--MFIR
SUBSTRING(CQGMNYF1_Record,303,17),--MFMR
SUBSTRING(CQGMNYF1_Record,320,17),--MFEXIR
SUBSTRING(CQGMNYF1_Record,337,17),--MME
SUBSTRING(CQGMNYF1_Record,354,17),--MOTE
SUBSTRING(CQGMNYF1_Record,371,17),--MSMA
SUBSTRING(CQGMNYF1_Record,388,17),--MLOOTE
SUBSTRING(CQGMNYF1_Record,405,17),--MSOOTE
SUBSTRING(CQGMNYF1_Record,422,17),--MAVGEQ
SUBSTRING(CQGMNYF1_Record,439,17),--MMTDCM
SUBSTRING(CQGMNYF1_Record,456,17),--MUNLMV
SUBSTRING(CQGMNYF1_Record,473,17),--MTDBAL
SUBSTRING(CQGMNYF1_Record,490,17),--MUNSMV
SUBSTRING(CQGMNYF1_Record,507,17),--MMMHC
SUBSTRING(CQGMNYF1_Record,524,17),--MUNDPC
SUBSTRING(CQGMNYF1_Record,541,17),--MMTDPL
SUBSTRING(CQGMNYF1_Record,558,17),--MSEGLV
SUBSTRING(CQGMNYF1_Record,575,17),--MSEGSV
SUBSTRING(CQGMNYF1_Record,592,17),--MEIR
SUBSTRING(CQGMNYF1_Record,609,17),--MEMR
SUBSTRING(CQGMNYF1_Record,626,17),--MCVTFB
SUBSTRING(CQGMNYF1_Record,643,17),--MDVBAL
SUBSTRING(CQGMNYF1_Record,660,17),--MJPUPL
SUBSTRING(CQGMNYF1_Record,677,17),--MFOOTE
SUBSTRING(CQGMNYF1_Record,694,17),--MLOANV
SUBSTRING(CQGMNYF1_Record,711,17),--MBYPWR
SUBSTRING(CQGMNYF1_Record,728,17),--MPNDIV
SUBSTRING(CQGMNYF1_Record,745,17),--MPNINT
SUBSTRING(CQGMNYF1_Record,762,17),--MLQVAL
SUBSTRING(CQGMNYF1_Record,779,17),--MMRGVL
SUBSTRING(CQGMNYF1_Record,796,17),--MOTECR
SUBSTRING(CQGMNYF1_Record,813,17),--MOTEDR
SUBSTRING(CQGMNYF1_Record,830,17),--MPREM
SUBSTRING(CQGMNYF1_Record,847,17),--MOOTEC
SUBSTRING(CQGMNYF1_Record,864,17),--MAVSOD
SUBSTRING(CQGMNYF1_Record,881,17),--MLOPRM
SUBSTRING(CQGMNYF1_Record,898,17),--MUNUPL
SUBSTRING(CQGMNYF1_Record,915,17),--MAVGME
SUBSTRING(CQGMNYF1_Record,932,17),--MJPIR
SUBSTRING(CQGMNYF1_Record,949,17),--MJPIRC
SUBSTRING(CQGMNYF1_Record,966,17),--MJPMR
SUBSTRING(CQGMNYF1_Record,983,17),--MJPRT2
SUBSTRING(CQGMNYF1_Record,1000,17),--MTAR
SUBSTRING(CQGMNYF1_Record,1017,17),--MEPOTE
SUBSTRING(CQGMNYF1_Record,1034,17),--MLVUST
SUBSTRING(CQGMNYF1_Record,1051,17),--MTE
SUBSTRING(CQGMNYF1_Record,1068,17),--MAVGBL
SUBSTRING(CQGMNYF1_Record,1085,17),--MAVGOV
SUBSTRING(CQGMNYF1_Record,1102,17),--MCVTAB
SUBSTRING(CQGMNYF1_Record,1119,17),--MCMACR
SUBSTRING(CQGMNYF1_Record,1136,17),--MCMACU
SUBSTRING(CQGMNYF1_Record,1153,17),--MSPNOV
SUBSTRING(CQGMNYF1_Record,1170,17),--MEEXM
SUBSTRING(CQGMNYF1_Record,1187,17),--MEIRT
SUBSTRING(CQGMNYF1_Record,1204,17),--MEOIR
SUBSTRING(CQGMNYF1_Record,1221,17),--MEOMR
SUBSTRING(CQGMNYF1_Record,1238,17),--MFEXMR
SUBSTRING(CQGMNYF1_Record,1255,17),--MGEUDC
SUBSTRING(CQGMNYF1_Record,1272,17),--MNCOTE
SUBSTRING(CQGMNYF1_Record,1289,17),--MCCDNT
SUBSTRING(CQGMNYF1_Record,1306,17),--MEQPCT
SUBSTRING(CQGMNYF1_Record,1323,17),--MREGCV
SUBSTRING(CQGMNYF1_Record,1340,17),--MCVTAF
SUBSTRING(CQGMNYF1_Record,1357,17),--MTDVAL
SUBSTRING(CQGMNYF1_Record,1374,17),--MTCC
SUBSTRING(CQGMNYF1_Record,1391,17),--MMRGLM
SUBSTRING(CQGMNYF1_Record,1408,17),--MPNOTH
SUBSTRING(CQGMNYF1_Record,1425,17),--MIRCIC
SUBSTRING(CQGMNYF1_Record,1442,17),--MIRCEC
SUBSTRING(CQGMNYF1_Record,1459,17),--MDEFOT
SUBSTRING(CQGMNYF1_Record,1476,17),--MSECAM
SUBSTRING(CQGMNYF1_Record,1493,17),--MCLMGN
SUBSTRING(CQGMNYF1_Record,1510,17),--MCLOTE
SUBSTRING(CQGMNYF1_Record,1527,17),--MSPNAE
SUBSTRING(CQGMNYF1_Record,1544,17),--MMVUCI
SUBSTRING(CQGMNYF1_Record,1561,17),--MACRET
SUBSTRING(CQGMNYF1_Record,1578,17),--MPOOTE
SUBSTRING(CQGMNYF1_Record,1595,17),--MUNDEP
SUBSTRING(CQGMNYF1_Record,1612,17),--MPRTC
SUBSTRING(CQGMNYF1_Record,1629,17),--MPRSMA
SUBSTRING(CQGMNYF1_Record,1646,17),--MLVTM4
SUBSTRING(CQGMNYF1_Record,1663,17),--MLVTM3
SUBSTRING(CQGMNYF1_Record,1680,17),--MLVTM2
SUBSTRING(CQGMNYF1_Record,1697,17),--MPREOI
SUBSTRING(CQGMNYF1_Record,1714,17),--MPREIR
SUBSTRING(CQGMNYF1_Record,1731,17),--MPRFXM
SUBSTRING(CQGMNYF1_Record,1748,17),--MPRFXI
SUBSTRING(CQGMNYF1_Record,1765,17),--MPRFIR
SUBSTRING(CQGMNYF1_Record,1782,17),--MPROTE
SUBSTRING(CQGMNYF1_Record,1799,17),--MPRTE
SUBSTRING(CQGMNYF1_Record,1816,17),--MPRLQV
SUBSTRING(CQGMNYF1_Record,1833,17),--MPRRCV
SUBSTRING(CQGMNYF1_Record,1850,17),--MPRBAL
SUBSTRING(CQGMNYF1_Record,1867,1),--MBNRY1
SUBSTRING(CQGMNYF1_Record,1868,1),--MBNRY2
SUBSTRING(CQGMNYF1_Record,1869,1),--MBNRY3
SUBSTRING(CQGMNYF1_Record,1870,1),--MBNRY4
SUBSTRING(CQGMNYF1_Record,1871,1),--MBNRY5
SUBSTRING(CQGMNYF1_Record,1872,1),--MMISC1
SUBSTRING(CQGMNYF1_Record,1873,1),--MMISC2
SUBSTRING(CQGMNYF1_Record,1874,1),--MMISC3
SUBSTRING(CQGMNYF1_Record,1875,1),--MMISC4
SUBSTRING(CQGMNYF1_Record,1876,1),--MMISC5
SUBSTRING(CQGMNYF1_Record,1877,1),--MMISC6
SUBSTRING(CQGMNYF1_Record,1878,1),--MMISC7
SUBSTRING(CQGMNYF1_Record,1879,1),--MMISC8
SUBSTRING(CQGMNYF1_Record,1880,1),--MMISC9
SUBSTRING(CQGMNYF1_Record,1881,1),--MMISC0
SUBSTRING(CQGMNYF1_Record,1882,1),--MCND01
SUBSTRING(CQGMNYF1_Record,1883,1),--MCND02
SUBSTRING(CQGMNYF1_Record,1884,1),--MCND03
SUBSTRING(CQGMNYF1_Record,1885,1),--MCND04
SUBSTRING(CQGMNYF1_Record,1886,1),--MCND05
SUBSTRING(CQGMNYF1_Record,1887,1),--MCND06
SUBSTRING(CQGMNYF1_Record,1888,1),--MCND07
SUBSTRING(CQGMNYF1_Record,1889,1),--MCND08
SUBSTRING(CQGMNYF1_Record,1890,1),--MCND09
SUBSTRING(CQGMNYF1_Record,1891,1),--MCND10
SUBSTRING(CQGMNYF1_Record,1892,1),--MUSFL1
SUBSTRING(CQGMNYF1_Record,1893,1),--MUSFL2
SUBSTRING(CQGMNYF1_Record,1894,1),--MUSFL3
SUBSTRING(CQGMNYF1_Record,1895,1),--MUSFL4
SUBSTRING(CQGMNYF1_Record,1896,1),--MUSFL5
SUBSTRING(CQGMNYF1_Record,1897,1),--MUSFL6
SUBSTRING(CQGMNYF1_Record,1898,1),--MUSFL7
SUBSTRING(CQGMNYF1_Record,1899,1),--MUSFL8
SUBSTRING(CQGMNYF1_Record,1900,1),--MUSFL9
SUBSTRING(CQGMNYF1_Record,1901,1),--MUSFLA
SUBSTRING(CQGMNYF1_Record,1902,1),--MUKFL1
SUBSTRING(CQGMNYF1_Record,1903,2),--MUKFL2
SUBSTRING(CQGMNYF1_Record,1905,1),--MUKFL3
SUBSTRING(CQGMNYF1_Record,1906,1),--MUKFL4
SUBSTRING(CQGMNYF1_Record,1907,1),--MFRFL1
SUBSTRING(CQGMNYF1_Record,1908,1),--MFRFL2
SUBSTRING(CQGMNYF1_Record,1909,1),--MFRFL3
SUBSTRING(CQGMNYF1_Record,1910,1),--MJPFL1
SUBSTRING(CQGMNYF1_Record,1911,1),--MJPFL2
SUBSTRING(CQGMNYF1_Record,1912,1),--MJPFL3
SUBSTRING(CQGMNYF1_Record,1913,1),--MHKFL1
SUBSTRING(CQGMNYF1_Record,1914,1),--MGEFL1
SUBSTRING(CQGMNYF1_Record,1915,1),--MITFL1
SUBSTRING(CQGMNYF1_Record,1916,2)--EOREC
FROM [dbo].[CQGMNYF1_File_Raw]

SELECT @@ROWCOUNT "Records Loaded"

SELECT GETDATE() "End Time"

PRINT '************************************************************************************************************'
PRINT ' [dbo].[PROC_Load_CQGMNYF1_File_Current] ENDED'
PRINT '************************************************************************************************************'
SELECT GETDATE() "End Time"


SET NOCOUNT OFF

GO