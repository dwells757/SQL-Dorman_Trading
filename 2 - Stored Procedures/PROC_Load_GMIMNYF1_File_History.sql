USE [GMIDATA]
GO

DROP PROCEDURE [dbo].[PROC_Load_GMIMNYF1_File_History]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[PROC_Load_GMIMNYF1_File_History]

AS

SET NOCOUNT ON

PRINT '************************************************************************************************************'
PRINT ' [dbo].[PROC_Load_GMIMNYF1_File_History] STARTED'
PRINT '************************************************************************************************************'
SELECT GETDATE() "Start Time"

DECLARE
@dte_Current_Processing_Date DATE

SELECT @dte_Current_Processing_Date=Current_Processing_Date
FROM [dbo].[GMI_Information]

SELECT @dte_Current_Processing_Date "@dte_Current_Processing_Date"

--PRINT '**************************************************************************'
--PRINT ' DELETE FROM [dbo].[GMIMNYF1_File_History]'
--PRINT ' WHERE (Processing_Date="' + CONVERT(VARCHAR,@dte_Current_Processing_Date,101) + '"'
--PRINT '**************************************************************************'
--DELETE FROM [dbo].[GMIMNYF1_File_History]
--WHERE (Processing_Date=@dte_Current_Processing_Date)

--SELECT @@ROWCOUNT "Records Deleted"

PRINT '**************************************************************************'
PRINT ' Load [dbo].[GMIMNYF1_File_History]'
PRINT ' with [dbo].[GMIMNYF1_File_Current]'
PRINT '**************************************************************************'

INSERT INTO [dbo].[GMIMNYF1_File_History]
(Processing_Date,
MRECID,
MFIRM,
MOFFIC,
MACCT,
MATYPE,
MRR,
MCLASS,
MSUBCL,
MCURAT,
MCURCD,
MCURAC,
MCURFM,
MCPCOD,
MNCALL,
MCAGE,
MFILL1,
MAVDYS,
MDSCCD,
MOMNCD,
MACNTY,
MMPGMN,
MSNAME,
MNA1,
MDLACT,
MDLACW,
MREL1F,
MREL1O,
MREL1A,
MREL1T,
MREL2F,
MREL2O,
MREL2A,
MREL2T,
MREL3F,
MREL3O,
MREL3A,
MREL3T,
MGRPFM,
MGRPOF,
MGRPRR,
MGRPAC,
MBAL,
MLMV,
MSMV,
MLOV,
MSOV,
MTC,
MWF,
MFIR,
MFMR,
MFEXIR,
MME,
MOTE,
MSMA,
MLOOTE,
MSOOTE,
MAVGEQ,
MMTDCM,
MUNLMV,
MTDBAL,
MUNSMV,
MMMHC,
MUNDPC,
MMTDPL,
MSEGLV,
MSEGSV,
MEIR,
MEMR,
MCVTFB,
MDVBAL,
MJPUPL,
MFOOTE,
MLOANV,
MBYPWR,
MPNDIV,
MPNINT,
MLQVAL,
MMRGVL,
MOTECR,
MOTEDR,
MPREM,
MOOTEC,
MAVSOD,
MLOPRM,
MUNUPL,
MAVGME,
MJPIR,
MJPIRC,
MJPMR,
MJPRT2,
MTAR,
MEPOTE,
MLVUST,
MTE,
MAVGBL,
MAVGOV,
MCVTAB,
MCMACR,
MCMACU,
MSPNOV,
MEEXM,
MEIRT,
MEOIR,
MEOMR,
MFEXMR,
MGEUDC,
MNCOTE,
MCCDNT,
MEQPCT,
MREGCV,
MCVTAF,
MTDVAL,
MTCC,
MMRGLM,
MPNOTH,
MIRCIC,
MIRCEC,
MDEFOT,
MSECAM,
MCLMGN,
MCLOTE,
MSPNAE,
MMVUCI,
MACRET,
MPOOTE,
MUNDEP,
MPRTC,
MPRSMA,
MLVTM4,
MLVTM3,
MLVTM2,
MPREOI,
MPREIR,
MPRFXM,
MPRFXI,
MPRFIR,
MPROTE,
MPRTE,
MPRLQV,
MPRRCV,
MPRBAL,
MBNRY1,
MBNRY2,
MBNRY3,
MBNRY4,
MBNRY5,
MMISC1,
MMISC2,
MMISC3,
MMISC4,
MMISC5,
MMISC6,
MMISC7,
MMISC8,
MMISC9,
MMISC0,
MCND01,
MCND02,
MCND03,
MCND04,
MCND05,
MCND06,
MCND07,
MCND08,
MCND09,
MCND10,
MUSFL1,
MUSFL2,
MUSFL3,
MUSFL4,
MUSFL5,
MUSFL6,
MUSFL7,
MUSFL8,
MUSFL9,
MUSFLA,
MUKFL1,
MUKFL2,
MUKFL3,
MUKFL4,
MFRFL1,
MFRFL2,
MFRFL3,
MJPFL1,
MJPFL2,
MJPFL3,
MHKFL1,
MGEFL1,
MITFL1,
DateLoaded)
SELECT
@dte_Current_Processing_Date, --Processing_Date
MRECID,
MFIRM,
MOFFIC,
MACCT,
MATYPE,
MRR,
MCLASS,
MSUBCL,
MCURAT,
MCURCD,
MCURAC,
MCURFM,
MCPCOD,
MNCALL,
MCAGE,
MFILL1,
MAVDYS,
MDSCCD,
MOMNCD,
MACNTY,
MMPGMN,
MSNAME,
MNA1,
MDLACT,
MDLACW,
MREL1F,
MREL1O,
MREL1A,
MREL1T,
MREL2F,
MREL2O,
MREL2A,
MREL2T,
MREL3F,
MREL3O,
MREL3A,
MREL3T,
MGRPFM,
MGRPOF,
MGRPRR,
MGRPAC,
MBAL,
MLMV,
MSMV,
MLOV,
MSOV,
MTC,
MWF,
MFIR,
MFMR,
MFEXIR,
MME,
MOTE,
MSMA,
MLOOTE,
MSOOTE,
MAVGEQ,
MMTDCM,
MUNLMV,
MTDBAL,
MUNSMV,
MMMHC,
MUNDPC,
MMTDPL,
MSEGLV,
MSEGSV,
MEIR,
MEMR,
MCVTFB,
MDVBAL,
MJPUPL,
MFOOTE,
MLOANV,
MBYPWR,
MPNDIV,
MPNINT,
MLQVAL,
MMRGVL,
MOTECR,
MOTEDR,
MPREM,
MOOTEC,
MAVSOD,
MLOPRM,
MUNUPL,
MAVGME,
MJPIR,
MJPIRC,
MJPMR,
MJPRT2,
MTAR,
MEPOTE,
MLVUST,
MTE,
MAVGBL,
MAVGOV,
MCVTAB,
MCMACR,
MCMACU,
MSPNOV,
MEEXM,
MEIRT,
MEOIR,
MEOMR,
MFEXMR,
MGEUDC,
MNCOTE,
MCCDNT,
MEQPCT,
MREGCV,
MCVTAF,
MTDVAL,
MTCC,
MMRGLM,
MPNOTH,
MIRCIC,
MIRCEC,
MDEFOT,
MSECAM,
MCLMGN,
MCLOTE,
MSPNAE,
MMVUCI,
MACRET,
MPOOTE,
MUNDEP,
MPRTC,
MPRSMA,
MLVTM4,
MLVTM3,
MLVTM2,
MPREOI,
MPREIR,
MPRFXM,
MPRFXI,
MPRFIR,
MPROTE,
MPRTE,
MPRLQV,
MPRRCV,
MPRBAL,
MBNRY1,
MBNRY2,
MBNRY3,
MBNRY4,
MBNRY5,
MMISC1,
MMISC2,
MMISC3,
MMISC4,
MMISC5,
MMISC6,
MMISC7,
MMISC8,
MMISC9,
MMISC0,
MCND01,
MCND02,
MCND03,
MCND04,
MCND05,
MCND06,
MCND07,
MCND08,
MCND09,
MCND10,
MUSFL1,
MUSFL2,
MUSFL3,
MUSFL4,
MUSFL5,
MUSFL6,
MUSFL7,
MUSFL8,
MUSFL9,
MUSFLA,
MUKFL1,
MUKFL2,
MUKFL3,
MUKFL4,
MFRFL1,
MFRFL2,
MFRFL3,
MJPFL1,
MJPFL2,
MJPFL3,
MHKFL1,
MGEFL1,
MITFL1,
DateLoaded
FROM [dbo].[GMIMNYF1_File_Current]

SELECT @@ROWCOUNT "Records Loaded"

PRINT '************************************************************************************************************'
PRINT ' [dbo].[PROC_Load_GMIMNYF1_File_History] ENDED'
PRINT '************************************************************************************************************'
SELECT GETDATE() "End Time"


SET NOCOUNT OFF

GO