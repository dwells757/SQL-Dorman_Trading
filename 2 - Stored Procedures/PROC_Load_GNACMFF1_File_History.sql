USE [GMIDATA]
GO

DROP PROCEDURE [dbo].[PROC_Load_GNACMFF1_File_History]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[PROC_Load_GNACMFF1_File_History]

AS

SET NOCOUNT ON

PRINT '************************************************************************************************************'
PRINT ' [dbo].[PROC_Load_GNACMFF1_File_History] STARTED'
PRINT '************************************************************************************************************'
SELECT GETDATE() "Start Time"

DECLARE
@dte_Current_Processing_Date DATE

SELECT @dte_Current_Processing_Date=Current_Processing_Date
FROM [dbo].[GMI_Information]

SELECT @dte_Current_Processing_Date "@dte_Current_Processing_Date"

--PRINT '**************************************************************************'
--PRINT ' DELETE FROM [dbo].[GNACMFF1_File_History]'
--PRINT ' WHERE (Processing_Date="' + CONVERT(VARCHAR,@dte_Current_Processing_Date,101) + '"'
--PRINT '**************************************************************************'
--DELETE FROM [dbo].[GNACMFF1_File_History]
--WHERE (Processing_Date=@dte_Current_Processing_Date)

--SELECT @@ROWCOUNT "Records Deleted"

PRINT '**************************************************************************'
PRINT ' Load [dbo].[GNACMFF1_File_History]'
PRINT ' with [dbo].[GNACMFF1_File_Current]'
PRINT '**************************************************************************'

INSERT INTO [dbo].[GNACMFF1_File_History]
(Processing_Date,
YRECID,
YFIRM,
YOFFIC,
YACCT,
YRR,
YCLASS,
YSUBCL,
YSNAME,
YTAXID,
YTAXFM,
YTAXPC,
YTAXWH,
YTAXWR,
YTAXDC,
YTAXDR,
YTAXIC,
YTAXIR,
YTAXTC,
YNOBO,
YDTCCH,
YRELMD,
YADSTL,
YCITYL,
YMAILG,
YPSTCD,
YPSTSF,
YSTAC3,
YCNTRY,
YCURCD,
YCURAC,
YATYAC,
YCPCOD,
YCVRID,
YBCNVP,
YCVCAS,
YFASRC,
YSCMNA,
YCOLMA,
YAUCOL,
YMPGMN,
YINACT,
YBLNK,
YNA1,
YNA2,
YNA3,
YNA4,
YNA5,
YNA6,
YNA7,
YOMNBS,
YOMNBF,
YOITYP,
YHTRTF,
YHTRTO,
YCMREC,
YHEDGE,
YSSECF,
YNFACD,
YDSCCD,
YFPLCD,
YSPLCD,
YFFIFO,
YSFIFO,
YCNTRA,
YFCNTR,
YWOWND,
YSCONF,
YFCONF,
YFMEMO,
YSMEMO,
YLIFCL,
YFBBIL,
YOCOFF,
YFMTAB,
YFMPCT,
YFMCAL,
YTCNF1,
YTCNF2,
YMRQCD,
YCHGMC,
YLEGAL,
YOCC1,
YOCC2,
YCOMOF,
YCOMAC,
YMGROF,
YMGRRR,
YGLGRP,
YFMLIM,
YFMMUL,
YPLLAM,
YPLLML,
YCSHIM,
YVARMG,
YMEQPC,
YFCLIM,
YFCMUL,
YPSLMT,
YADGPC,
YGPCD,
YGRMGI,
YMSTRF,
YRSKC1,
YRSKC2,
YPLDET,
YPLSUM,
YPLFYR,
YPLCST,
YSKFEE,
YBIRTH,
YREL1F,
YREL1O,
YREL1A,
YREL1T,
YREL2F,
YREL2O,
YREL2A,
YREL2T,
YCFTOF,
YCFTAC,
YCFTSB,
YCFTF2,
YCFTO2,
YCFTA2,
YCFTS2,
YEXCOF,
YEXCAC,
YEXCSB,
YEXCF2,
YEXCO2,
YEXCA2,
YEXCS2,
YGRPFM,
YGRPOF,
YGRPAC,
YGRPRR,
YREFOF,
YREFRR,
YCBTOS,
YCBTOA,
YVIOOF,
YVIOAC,
YCOLFN,
YCOLOF,
YCOLAC,
YORGNM,
YPREXC,
YMISC1,
YMISC2,
YMISC3,
YMISC4,
YMISC5,
YMISC6,
YMISC7,
YMISC8,
YMISC9,
YMISC0,
YBUYIN,
YSELIN,
YFINID,
YFINAG,
YDVDSP,
YPFOLO,
YSORDR,
YSMODT,
YFXROL,
YEXEAF,
YOPTAG,
YSIGNC,
YNEOAG,
YIDXOP,
YTRM01,
YTRM02,
YTRM03,
YTRM04,
YTRM05,
YTRM06,
YTRM07,
YTRM08,
YTRM09,
YTRM10,
YUSER,
YOPNDT,
YUPDDT,
YCHGDT,
YDLACT,
YDLAC7,
YBNRY1,
YBNRY2,
YBNRY3,
YBNRY4,
YBNRY5,
YBNRYI,
YBNRYR,
YGSFE1,
YGSFE2,
YGSFE3,
YGSFE4,
YGSFE5,
YGSFE6,
YGSFE7,
YGSFE8,
YALOCT,
YQIBST,
YCMMCL,
YSIPC,
YSFDEL,
YFAVGP,
YJPOCC,
YXTRA7,
YXTRA8,
YXTRA9,
YBLK20,
YCLCAT,
YMCRUL,
YEBKRP,
YTOPRP,
YHKERP,
YHKALW,
YBENID,
YHKOMN,
YMKLIC,
YLFIRM,
YLOFFC,
YLACCT,
YSUBAC,
YAICIA,
YGPOFC,
YGPACC,
YGPOFF,
YGPACF,
YALMTH,
YTXMTH,
YCLRFO,
YSEGMG,
YBENOF,
YOTCCF,
DateLoaded)
SELECT
@dte_Current_Processing_Date, --Processing_Date
YRECID,
YFIRM,
YOFFIC,
YACCT,
YRR,
YCLASS,
YSUBCL,
YSNAME,
YTAXID,
YTAXFM,
YTAXPC,
YTAXWH,
YTAXWR,
YTAXDC,
YTAXDR,
YTAXIC,
YTAXIR,
YTAXTC,
YNOBO,
YDTCCH,
YRELMD,
YADSTL,
YCITYL,
YMAILG,
YPSTCD,
YPSTSF,
YSTAC3,
YCNTRY,
YCURCD,
YCURAC,
YATYAC,
YCPCOD,
YCVRID,
YBCNVP,
YCVCAS,
YFASRC,
YSCMNA,
YCOLMA,
YAUCOL,
YMPGMN,
YINACT,
YBLNK,
YNA1,
YNA2,
YNA3,
YNA4,
YNA5,
YNA6,
YNA7,
YOMNBS,
YOMNBF,
YOITYP,
YHTRTF,
YHTRTO,
YCMREC,
YHEDGE,
YSSECF,
YNFACD,
YDSCCD,
YFPLCD,
YSPLCD,
YFFIFO,
YSFIFO,
YCNTRA,
YFCNTR,
YWOWND,
YSCONF,
YFCONF,
YFMEMO,
YSMEMO,
YLIFCL,
YFBBIL,
YOCOFF,
YFMTAB,
YFMPCT,
YFMCAL,
YTCNF1,
YTCNF2,
YMRQCD,
YCHGMC,
YLEGAL,
YOCC1,
YOCC2,
YCOMOF,
YCOMAC,
YMGROF,
YMGRRR,
YGLGRP,
YFMLIM,
YFMMUL,
YPLLAM,
YPLLML,
YCSHIM,
YVARMG,
YMEQPC,
YFCLIM,
YFCMUL,
YPSLMT,
YADGPC,
YGPCD,
YGRMGI,
YMSTRF,
YRSKC1,
YRSKC2,
YPLDET,
YPLSUM,
YPLFYR,
YPLCST,
YSKFEE,
YBIRTH,
YREL1F,
YREL1O,
YREL1A,
YREL1T,
YREL2F,
YREL2O,
YREL2A,
YREL2T,
YCFTOF,
YCFTAC,
YCFTSB,
YCFTF2,
YCFTO2,
YCFTA2,
YCFTS2,
YEXCOF,
YEXCAC,
YEXCSB,
YEXCF2,
YEXCO2,
YEXCA2,
YEXCS2,
YGRPFM,
YGRPOF,
YGRPAC,
YGRPRR,
YREFOF,
YREFRR,
YCBTOS,
YCBTOA,
YVIOOF,
YVIOAC,
YCOLFN,
YCOLOF,
YCOLAC,
YORGNM,
YPREXC,
YMISC1,
YMISC2,
YMISC3,
YMISC4,
YMISC5,
YMISC6,
YMISC7,
YMISC8,
YMISC9,
YMISC0,
YBUYIN,
YSELIN,
YFINID,
YFINAG,
YDVDSP,
YPFOLO,
YSORDR,
YSMODT,
YFXROL,
YEXEAF,
YOPTAG,
YSIGNC,
YNEOAG,
YIDXOP,
YTRM01,
YTRM02,
YTRM03,
YTRM04,
YTRM05,
YTRM06,
YTRM07,
YTRM08,
YTRM09,
YTRM10,
YUSER,
YOPNDT,
YUPDDT,
YCHGDT,
YDLACT,
YDLAC7,
YBNRY1,
YBNRY2,
YBNRY3,
YBNRY4,
YBNRY5,
YBNRYI,
YBNRYR,
YGSFE1,
YGSFE2,
YGSFE3,
YGSFE4,
YGSFE5,
YGSFE6,
YGSFE7,
YGSFE8,
YALOCT,
YQIBST,
YCMMCL,
YSIPC,
YSFDEL,
YFAVGP,
YJPOCC,
YXTRA7,
YXTRA8,
YXTRA9,
YBLK20,
YCLCAT,
YMCRUL,
YEBKRP,
YTOPRP,
YHKERP,
YHKALW,
YBENID,
YHKOMN,
YMKLIC,
YLFIRM,
YLOFFC,
YLACCT,
YSUBAC,
YAICIA,
YGPOFC,
YGPACC,
YGPOFF,
YGPACF,
YALMTH,
YTXMTH,
YCLRFO,
YSEGMG,
YBENOF,
YOTCCF,
DateLoaded
FROM [dbo].[GNACMFF1_File_Current]

SELECT @@ROWCOUNT "Records Loaded"

PRINT '************************************************************************************************************'
PRINT ' [dbo].[PROC_Load_GNACMFF1_File_History] ENDED'
PRINT '************************************************************************************************************'
SELECT GETDATE() "End Time"


SET NOCOUNT OFF

GO